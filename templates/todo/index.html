{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
  <h1 class="mb-4 d-flex justify-content-between align-items-center">
    <strong>TODO list</strong>
    <a href="{% url 'todo:task-create' %}" class="btn btn-primary">Add task</a>
  </h1>

  {% if task_list %}
    {% for task in task_list %}
      <div class="task-item border-bottom py-3 d-flex justify-content-between align-items-start flex-wrap">

        <div class="task-info" style="flex: 1 1 auto; min-width: 250px;">
          <h4 class="fw-bold mb-1">
            {{ task.content }}
            {% if task.complete %}
              <span class="text-success">Done</span>
            {% else %}
              <span class="text-danger">Not done</span>
            {% endif %}
          </h4>

          <p class="text-muted mb-1 small">
            Created: {{ task.created|date:"F j, Y, g:i a" }}
            {% if task.deadline %}
              <span class="text-danger">Deadline: {{ task.deadline|date:"F j, Y, g:i a" }}</span>
            {% endif %}
          </p>

          <p class="mb-0 small">
            <strong>Tags:</strong>
            {% for tag in task.tags.all %}
              {{ tag.name }}{% if not forloop.last %} {% endif %}
            {% empty %}
              no tags
            {% endfor %}
            <a href="{% url 'todo:task-update' pk=task.id %}" class="text-primary text-decoration-none me-2">Update</a>
            <a href="{% url 'todo:task-delete' pk=task.id %}" class="text-primary text-decoration-none">Delete</a>
          </p>
        </div>

        <div class="task-action ms-3 mt-2 mt-md-0">
          {% if task.complete %}
            <a href="{% url 'todo:toggle_task_status' task.id %}" class="btn btn-secondary btn-sm">Undo</a>
          {% else %}
            <a href="{% url 'todo:toggle_task_status' task.id %}" class="btn btn-success btn-sm">Complete</a>
          {% endif %}
        </div>

      </div>
    {% endfor %}
  {% else %}
    <p>There are no tasks yet.</p>
  {% endif %}
</div>
{% endblock %}